# Clustering Analysis of Quantal Responses in GPe Subregions

This repository contains the MATLAB implementation for quantifying the distinctiveness of specific brain regions (DL, VL, DM, VM) based on their quantal characteristics. This pipeline was utilized to generate **Extended Data Figure 8** for our publication.

## Overview

The analysis follows a multi-step statistical framework to determine if certain brain regions are uniquely represented within clusters identified through unsupervised learning.

### Key Features:

- **Data Preprocessing**: Feature concatenation (AMP, RT, DT), outlier removal (percentile-based), and Z-score standardization.
    
- **Dimensionality Reduction**: Principal Component Analysis (PCA) to evaluate variance explained by each component.
    
- **Recursive k-means Clustering**: Automated sub-clustering using the **Calinski-Harabasz** criterion to objectively determine the optimal number of clusters ($k$).
    
- **Statistical Validation**:
    
    - $\chi^2$ (Chi-square) tests to generate a region-by-cluster Z-matrix.
        
    - Permutation testing ($10^4$ iterations) for region-wise distinctiveness ($\Sigma Z^2$).
        
    - Pairwise $\Delta S$ permutation tests with **Holm-Bonferroni** and **FDR (BH)** corrections.
        

---

## Repository Structure

- `analysis_main.m`: The primary MATLAB script containing the full pipeline.

- `recursiveKMeansAuto.m`: Custom MATLAB function for automated sub-clustering.

- `Excel2mat_GPe.m`: MATLAB script used to convert data saved in .xlsx file to .mat file for analysis.
    
- `data/`: Contains the data files including GPe_SR2+_mini.mat used in the study.

- `outputs/figures/`: High-resolution PDF plots generated by the script (equivalent to Extended Data Fig. 8).

- `outputs/statistics/`: Numerical results used as the **direct source for all generated figures**. This includes:
    * The region-by-cluster $Z$-matrix.
    * Observed $\Sigma Z^2$ values and $\Delta S$ statistics.
    * Permutated $\Sigma Z^2$ values.
    * Permutation test outputs ($p$-values).
    * etc.
    
- `README.md`: Project documentation.
    

---

## Requirements

- **MATLAB** (Tested on R2021a or later)
    
- **Statistics and Machine Learning Toolbox**
    

---

## Usage

1. **Clone the repository**:
    
    Bash
    
    ```
    git clone https://github.com/yelee03153/Striatopallidalsynapse.git
    ```
    
2. **Run the analysis**:
    
    Open MATLAB, navigate to the folder, and run:
    
    Matlab
    
    ```
    run('analysis_main.m')
    ```
    
3. **Outputs**:
    
    The script will generate and automatically save several high-resolution PDF figures (600 DPI) corresponding to the paper's extended data.
    

---

## Contact

**Minseok Jeong** Neuroscience Graduate Student

minseok4787@gmail.com

[JIKIMLAB](https://jikimlab.imweb.me/)

---
